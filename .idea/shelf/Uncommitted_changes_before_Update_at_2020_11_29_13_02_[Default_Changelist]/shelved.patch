Index: src/components/Students/course.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><template>\r\n  <div>\r\n    <!-- 面包屑导航区 -->\r\n    <el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n      <el-breadcrumb-item :to=\"{ path: '/home' }\">首页</el-breadcrumb-item>\r\n      <el-breadcrumb-item>病案管理</el-breadcrumb-item>\r\n      <el-breadcrumb-item>病历管理</el-breadcrumb-item>\r\n    </el-breadcrumb>\r\n    <!-- 卡片视图区 -->\r\n    <el-card>\r\n      <!-- 搜索与添加区域 -->\r\n      <el-row :gutter=\"20\">\r\n        <el-col :span=\"8\">\r\n          <el-input placeholder=\"请输入内容\" v-model=\"queryInfo.query\" clearable>\r\n            <el-button slot=\"append\" icon=\"el-icon-search\" @click=\"getRecordListByName\"></el-button>\r\n          </el-input>\r\n        </el-col>\r\n        <el-col :span=\"4\">\r\n          <el-button type=\"primary\" @click=\"addDialogVisible = true\">添加病历</el-button>\r\n        </el-col>\r\n      </el-row>\r\n      <!-- 病历列表区域 -->\r\n      <el-table :data=\"recordlist\" border stripe>\r\n        <el-table-column type=\"index\"></el-table-column>\r\n        <el-table-column label=\"病人姓名\" prop=\"patientName\"></el-table-column>\r\n        <el-table-column label=\"年龄\" prop=\"patientAge\"></el-table-column>\r\n        <el-table-column label=\"性别\" prop=\"patientGender\"></el-table-column>\r\n        <el-table-column label=\"病人描述\" prop=\"patientSymptom\"></el-table-column>\r\n        <el-table-column label=\"诊断结果\" prop=\"diagnosisResult\"></el-table-column>\r\n        <el-table-column label=\"医生建议\" prop=\"doctorAdvice\"></el-table-column>\r\n        <el-table-column label=\"药方\" prop=\"medical\"></el-table-column>\r\n        <el-table-column label=\"主治医生\" prop=\"doctorName\"></el-table-column>\r\n        <el-table-column label=\"所属科室\" prop=\"departmentName\"></el-table-column>\r\n        <el-table-column label=\"操作\">\r\n          <template slot-scope=\"scope\">\r\n            <!-- 修改按钮 -->\r\n            <el-button type=\"primary\" icon=\"el-icon-edit\" circle @click=\"showEditDialog(scope.row.mrecordID,\r\n            scope.row.patientName,\r\n            scope.row.patientSymptom,\r\n            scope.row.diagnosisResult,\r\n            scope.row.doctorAdvice,\r\n            scope.row.medical)\"></el-button>\r\n            <!-- 删除按钮 -->\r\n            <el-button type=\"danger\" icon=\"el-icon-delete\" circle\r\n                       @click=\"removeRecordById(scope.row.mrecordID)\"></el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <!-- 分页区域 -->\r\n      <el-pagination @size-change=\"handleSizeChange\" @current-change=\"handleCurrentChange\"\r\n                     :current-page=\"queryInfo.pagenum\"\r\n                     :page-sizes=\"[2,5, 10, 15, 20]\" :page-size=\"queryInfo.pagesize\"\r\n                     layout=\"total, sizes, prev, pager, next, jumper\"\r\n                     :total=\"total\">\r\n      </el-pagination>\r\n    </el-card>\r\n\r\n    <!-- 添加病历的对话框 -->\r\n    <el-dialog title=\"添加病历\" :visible.sync=\"addDialogVisible\" width=\"50%\" @close=\"addDialogClosed\">\r\n      <!-- 内容主体区域 -->\r\n      <el-form :model=\"addForm\" :rules=\"addFormRules\" ref=\"addFormRef\" label-width=\"70px\">\r\n        <el-form-item label=\"选择病人\" prop=\"patientId\">\r\n          <el-select v-model=\"addForm.patientId\" placeholder=\"请选择病人\">\r\n            <el-option v-for=\"item in patientlist\" :key=\"item.patientId\" :label=\"item.patientName\"\r\n                       :value=\"item.patientId\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"病人描述\" prop=\"patientSymptom\">\r\n          <el-input v-model=\"addForm.patientSymptom\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"诊断结果\" prop=\"diagnosisResult\">\r\n          <el-input v-model=\"addForm.diagnosisResult\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"医生建议\" prop=\"doctorAdvice\">\r\n          <el-input v-model=\"addForm.doctorAdvice\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"药方\" prop=\"medical\">\r\n          <el-input v-model=\"addForm.medical\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <!-- 底部区域 -->\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button @click=\"addDialogVisible = false\">取 消</el-button>\r\n          <el-button type=\"primary\" @click=\"addRecord\">确 定</el-button>\r\n        </span>\r\n    </el-dialog>\r\n\r\n    <!-- 修改病历的对话框 -->\r\n    <el-dialog title=\"修改病历信息\" :visible.sync=\"editDialogVisible\" width=\"50%\" @close=\"editDialogClosed\">\r\n      <!-- 内容主体区域 -->\r\n      <el-form :model=\"editForm\" :rules=\"editFormRules\" ref=\"editFormRef\" label-width=\"70px\">\r\n        <el-form-item label=\"病人姓名\" prop=\"patientName\">\r\n          <el-input v-model=\"editForm.patientName\" disabled></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"病人描述\" prop=\"patientSymptom\">\r\n          <el-input v-model=\"editForm.patientSymptom\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"诊断结果\" prop=\"diagnosisResult\">\r\n          <el-input v-model=\"editForm.diagnosisResult\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"医生建议\" prop=\"doctorAdvice\">\r\n          <el-input v-model=\"editForm.doctorAdvice\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"药方\" prop=\"medical\">\r\n          <el-input v-model=\"editForm.medical\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <!-- 底部区域 -->\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button @click=\"editDialogVisible = false\">取 消</el-button>\r\n          <el-button type=\"primary\" @click=\"editRecordInfo\">确 定</el-button>\r\n        </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  export default {\r\n    data() {\r\n      return {\r\n        queryInfo: {\r\n          query: '',\r\n          //当前的页数\r\n          pagenum: 1,\r\n          //当前每页显示多少条数据\r\n          pagesize: 5\r\n        },\r\n        recordlist: [],\r\n        patientlist: [],\r\n        total: 0,\r\n        addDialogVisible: false,\r\n        editDialogVisible: false,\r\n        //添加病历的表单数据\r\n        addForm: {\r\n          patientId: '',\r\n          patientSymptom: '',\r\n          diagnosisResult: '',\r\n          doctorAdvice: '',\r\n          medical: ''\r\n        },\r\n        editForm: {\r\n          mrecordID: '',\r\n          patientName: '',\r\n          patientSymptom: '',\r\n          diagnosisResult: '',\r\n          doctorAdvice: '',\r\n          medical: ''\r\n        },\r\n        addFormRules: {\r\n          patientSymptom: [\r\n            {required: true, message: '请输入病人描述', trigger: 'blur'}\r\n          ],\r\n          diagnosisResult: [\r\n            {required: true, message: '请输入诊断结果', trigger: 'blur'}\r\n          ],\r\n          doctorAdvice: [\r\n            {required: true, message: '请输入医生建议', trigger: 'blur'}\r\n          ],\r\n          medical: [\r\n            {required: true, message: '请输入药方', trigger: 'blur'}\r\n          ]\r\n        },\r\n        editFormRules: {\r\n          patientSymptom: [\r\n            {required: true, message: '请输入病人描述', trigger: 'blur'}\r\n          ],\r\n          diagnosisResult: [\r\n            {required: true, message: '请输入诊断结果', trigger: 'blur'}\r\n          ],\r\n          doctorAdvice: [\r\n            {required: true, message: '请输入医生建议', trigger: 'blur'}\r\n          ],\r\n          medical: [\r\n            {required: true, message: '请输入药方', trigger: 'blur'}\r\n          ]\r\n        }\r\n      }\r\n    },\r\n    methods: {\r\n      //获取病历列表\r\n      async getRecordList() {\r\n        await this.$http.post('/studentSystem/getRecord', {\r\n          \"pagenum\": this.queryInfo.pagenum,\r\n          \"pagesize\": this.queryInfo.pagesize\r\n        }).then((response) => {\r\n          this.recordlist = response.data.list\r\n          this.total = response.data.total\r\n          console.log(response)\r\n        }).catch((error) => {\r\n          this.$message.warning(\"获取病历列表失败！\")\r\n          console.log(error)\r\n        })\r\n      },\r\n      async getRecordListByName() {\r\n        await this.$http.post('studentSystem/getCoursesByName', {\"courseName\": this.queryInfo.query}).then((response) => {\r\n          if (response.data.courses != null) {\r\n            this.courselist = response.data.courses\r\n            this.total = response.data.total\r\n          }\r\n          console.log(response)\r\n        }).catch((error) => {\r\n          console.log(error)\r\n        })\r\n      },\r\n      async getPatientList() {\r\n        await this.$http.post('/studentSystem/getAllPatient').then((response) => {\r\n          this.patientlist = response.data\r\n          console.log(this.patientlist)\r\n          console.log(this.recordlist)\r\n        }).catch((error) => {\r\n          console.log(error)\r\n        })\r\n      },\r\n\r\n      //监听pagesize改变的事件\r\n      handleSizeChange(newSize) {\r\n        this.queryInfo.pagesize = newSize\r\n        this.getRecordList()\r\n      },\r\n      //监听页码值改变的事件\r\n      handleCurrentChange(newPage) {\r\n        this.queryInfo.pagenum = newPage\r\n        this.getRecordList()\r\n      },\r\n      //监听添加病历对话框的关闭事件\r\n      addDialogClosed() {\r\n        this.$refs.addFormRef.resetFields();\r\n      },\r\n      //监听修改病历对话框的关闭事件\r\n      editDialogClosed() {\r\n        this.$refs.editFormRef.resetFields();\r\n      },\r\n      //展示编辑遍历的对话框\r\n      showEditDialog(mrecordID, patientName, patientSymptom, diagnosisResult, doctorAdvice, medical) {\r\n        this.editForm.mrecordID = mrecordID\r\n        this.editForm.patientName = patientName\r\n        this.editForm.patientSymptom = patientSymptom\r\n        this.editForm.diagnosisResult = diagnosisResult\r\n        this.editForm.doctorAdvice = doctorAdvice\r\n        this.editForm.medical = medical\r\n        this.editDialogVisible = true\r\n      },\r\n      addRecord() {\r\n        this.$refs.addFormRef.validate(async valid => {\r\n          if (!valid) return\r\n          //发起添加病历的网络请求\r\n          await this.$http.post('studentSystem/addRecord', this.addForm).then((response) => {\r\n            this.$message.success(\"添加病历成功！\")\r\n            this.getRecordList()\r\n          }).catch((error) => {\r\n            this.$message.warning(\"添加病历失败！\")\r\n            console.log(error)\r\n          })\r\n          this.addDialogVisible = false\r\n        })\r\n      },\r\n      editRecordInfo() {\r\n        this.$refs.editFormRef.validate(async valid => {\r\n          if (!valid) return\r\n          //发起修改用户信息的数据请求\r\n          await this.$http.post('studentSystem/updateRecord', this.editForm).then((response) => {\r\n            this.$message.success(\"修改病历信息成功!\")\r\n            //刷新病历列表数据\r\n            this.getRecordList();\r\n\r\n          }).catch((error) => {\r\n            this.$message.warning(\"修改病历信息失败！\")\r\n            console.log(error)\r\n          })\r\n          this.editDialogVisible = false\r\n        })\r\n      },\r\n      //根据Id删除对应的病历信息\r\n      async removeRecordById(mrecordID) {\r\n        //弹框询问用户是否删除数据\r\n        const confirmResult = await this.$confirm('此操作将永久删除该病历数据, 是否继续?', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).catch(err => err)\r\n        //如果用户确认删除则返回值为字符串confirm\r\n        //如果用户取消了删除则返回值为字符串cancel\r\n        if (confirmResult != 'confirm') {\r\n          return this.$message.info('已取消删除')\r\n        }\r\n        await this.$http.post('studentSystem/deleteRecord', {\"recordID\": mrecordID}).then((response) => {\r\n          this.$message.success('删除病历成功！')\r\n          this.getRecordList()\r\n        }).catch((error) => {\r\n          this.$message.warning(\"删除病历失败！\")\r\n          console.log(error)\r\n        })\r\n      }\r\n    },\r\n    created() {\r\n      this.getRecordList()\r\n      this.getPatientList()\r\n    }\r\n\r\n  }\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n\r\n</style>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/components/Students/course.vue	(revision c62727327bffe3a688d1c7e373185158cb95b8ec)
+++ src/components/Students/course.vue	(date 1606577942430)
@@ -285,6 +285,7 @@
         }
         await this.$http.post('studentSystem/deleteRecord', {"recordID": mrecordID}).then((response) => {
           this.$message.success('删除病历成功！')
+          this.queryInfo.pagenum = 1
           this.getRecordList()
         }).catch((error) => {
           this.$message.warning("删除病历失败！")
